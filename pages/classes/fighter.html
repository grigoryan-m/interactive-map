<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF–8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alegreya+SC:ital,wght@0,400;0,500;0,700;0,800;0,900;1,400;1,500;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <base href="https://grigoryan-m.github.io/interactive-map/" />
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/class.css">
    <script src="js/header.js"></script>
    <title>Воин</title>
</head>
<body data-class="fighter">

        <div class="center">
            <section class="">
                
            <h2>Воин</h2>
            <div class="tree">
                <h4>Описания веток</h4>
                <div class="level">
                    <div class="ability"><img src="res/icons/questionmark.jpg" alt="">
                    <p>Воинское лечение - связано с нанесением себе урона, чтобы лечить союзников или усиливать свои атаки.</p></div>
                    <div class="ability">
                        <img src="res/icons/questionmark.jpg" alt="">
                        <p>Максимальный урон - нанесение максимального урона и усиливание своих атак.</p>
                    </div>
                    <div class="ability">
                        <img src="res/icons/questionmark.jpg" alt="">
                        <p>Танк - повышение КД себе и союзникам, много хитов и спасение союзников.</p>
                    </div>
                </div>
                <hr/>
                <div class="level" data-level="0">
                    <div class="ability" data-index="0"><img src="res/icons/Blood Boil.png" alt="">
                    <p>Кровь вместо стали – Раз в ход можешь потратить 1/3 своих максимальных хитов вместо броска атаки, чтобы автоматически попасть по врагу.</p></div>
                    <div class="ability" data-index="1">
                        <img src="res/icons/SealOfMight.png" alt="">
                        <p>Разрыв брони – Если атака попадает, враг получает дополнительный урон = твоему мод. Силы.</p>
                    </div>
                    <div class="ability" data-index="2">
                        <img src="res/icons/MoltenArmor.png" alt="">
                        <p>Щит Стража – Если успешно защищаешь союзника, он получает +2 к КД до конца своего хода.</p>
                    </div>
                </div>
                <div class="level" data-level="1">
                    <div class="ability" data-index="3">
                        <img src="res/icons/Disguise.png" alt="">
                        <p>Жертва и возрождение – Раз в день можешь нанести себе урон 1d8 и восстановить такое же количество хитов союзнику.</p>
                    </div>
                    <div class="ability" data-index="4">
                        <img src="res/icons/Sap.png" alt="">
                        <p>Рывок убийцы – Если пробежал 10 футов перед атакой, добавляешь 1d6 урона.</p>
                    </div>
                    <div class="ability" data-index="5">
                        <img src="res/icons/AbolishMagic.png" alt="">
                        <p>Железная воля – Ты можешь игнорировать одну неудачу спасброска за бой.</p>
                    </div>
                </div>
                <div class="level" data-level="2">
                    <div class="ability" data-index="6">
                        <img src="res/icons/ArcaneBlast.png" alt="">
                        <p>Печать восстановления – Накладываешь магическую печать на союзника: если он упадет до 0 хитов, он сразу поднимается с 1d6 + Телосложение хитов. (1 раз за продолжительный отдых)</p>
                    </div>
                    <div class="ability" data-index="7">
                        <img src="res/icons/Rupture.png" alt="">
                        <p>Кровавый хаос – Когда получаешь урон, твоя следующая атака наносит дополнительный 1d6 урона.</p>
                    </div>
                    <div class="ability" data-index="8">
                        <img src="res/icons/SealOfProtection.png" alt="">
                        <p>Каменная стойкость – Получаешь +1 к КД.</p>
                    </div>
                </div>
                <div class="level" data-level="3">
                    <div class="ability" data-index="9">
                        <img src="res/icons/HolyNova.png" alt="">
                        <p>Вечный страж – Когда ты убиваешь врага, ближайший союзник в пределах 10 футов восстанавливает 2d4 хитов.</p>
                    </div>
                    <div class="ability" data-index="10">
                        <img src="res/icons/Quickshot.png" alt="">
                        <p>Бешенство битвы – Если убил врага, можешь атаковать ещё раз бонусным действием.</p>
                    </div>
                    <div class="ability" data-index="11">
                        <img src="res/icons/SealOfFury.png" alt="">
                        <p>Защитный удар – После успешного блока можешь атаковать в ответ.</p>
                    </div>
                </div>
                <div class="level" data-level="4">
                    <div class="ability" data-index="12">
                        <img src="res/icons/BladeOfJustice.png" alt="">
                        <p>Жертвенный клинок – При попадании по врагу можешь уменьшить свой урон вдвое, чтобы исцелить всех союзников в 10 футах на половину суммы урона.</p>
                    </div>
                    <div class="ability" data-index="13">
                        <img src="res/icons/Swift Strike.png" alt="">
                        <p>Неистовство – Если твои хиты меньше 30%, получаешь +2 к атаке и урону.</p>
                    </div>
                    <div class="ability" data-index="14">
                        <img src="res/icons/DivineAegis.png" alt="">
                        <p>Бастион – Если стоишь неподвижно, получаешь сопротивление к любому немагическому урону до начала своего следующего хода.</p>
                    </div>
                </div>
                <div class="level" data-level="5">
                    <div class="ability" data-index="15">
                        <img src="res/icons/InfusionOfLight.png" alt="">
                        <p>Боевой канон – Ты можешь использовать действие, чтобы восстановить 1d12 + уровень хитов всем в радиусе 15 футов. (1 раз за бой)</p>
                    </div>
                    <div class="ability" data-index="16">
                        <img src="res/icons/PowerStrikes.png" alt="">
                        <p>Разящий вихрь – Если попал по врагу, можешь атаковать ещё одного врага в радиусе 5 футов.</p>
                    </div>
                    <div class="ability" data-index="17">
                        <img src="res/icons/TouchOfDeath.png" alt="">
                        <p>Грозная защита – Ты можешь использовать действие, чтобы враги атаковали тебя с помехой до начала твоего следующего хода.</p>
                    </div>
                </div>
                <div class="level" data-level="6" >
                    <div class="ability" data-index="18">
                        <img src="res/icons/BloodTap.png" alt="">
                        <p>Кровавый прилив – Когда получаешь урон, ближайший союзник восстанавливает столько же хитов. (1 раз за бой)</p>
                    </div>
                    <div class="ability" data-index="19">
                        <img src="res/icons/Jab.png" alt="">
                        <p>Дробитель – Если нанес урон 20+, враг делает спасбросок Силы, иначе падает.</p>
                    </div>
                    <div class="ability" data-index="20">
                        <img src="res/icons/TouchOfKarma.png" alt="">
                        <p>Несокрушимый – Урон от критических атак уменьшается на половину.</p>
                    </div>
                </div>
                <div class="level" data-level="7">
                    <div class="ability" data-index="21">
                        <img src="res/icons/SurgeOfLight.png" alt="">
                        <p>Обет защиты – Раз в день можешь взять на себя весь урон, нанесенный союзнику.</p>
                    </div>
                    <div class="ability" data-index="22">
                        <img src="res/icons/KidneyShot.png" alt="">
                        <p>Кровавый след – Если ранил врага, он получает 1d6 урона в начале своего следующего хода.</p>
                    </div>
                    <div class="ability" data-index="23">
                        <img src="res/icons/IceboundFortitude.png" alt="">
                        <p>Живая крепость – Можешь сделать себя неподвижным до конца боя, получая +5 к КД.</p>
                    </div>
                </div>
                <div class="level" data-level="8">
                    <div class="ability" data-index="24">
                        <img src="res/icons/Ascension.png" alt="">
                        <p>Возвращение из бездны – Если твои хиты опускаются до нуля, восстанавливаешь 10 хитов (раз в день).</p>
                    </div>
                    <div class="ability" data-index="25">
                        <img src="res/icons/BladeOfJustice.png" alt="">
                        <p>Сокрушение – Ты можешь сконцентрироваться на атаке, потратив на это 2 хода (включая этот). Эта атака пробивает 9 единиц брони.</p>
                    </div>
                    <div class="ability" data-index="26">
                        <img src="res/icons/Exhilaration.png" alt="">
                        <p>Непробиваемый – Игнорируешь первые 5 урона каждого удара.</p>
                    </div>
                </div>
                <div class="level" data-level="9" >
                    <div class="ability" data-index="27">
                        <img src="res/icons/PrayerOfMending.png" alt="">
                        <p>Свет жизни – Когда исцеляешь союзника, следующая атака по нему совершается с помехой.</p>
                    </div>
                    <div class="ability" data-index="28">
                        <img src="res/icons/LavaBurst.png" alt="">
                        <p>Огненный удар – Если убил врага, следующий удар наносит доп. 1d8 огненного урона.</p>
                    </div>
                    <div class="ability" data-index="29">
                        <img src="res/icons/RayOfHope.png" alt="">
                        <p>Каменный великан – Получаешь +20 к максимуму хитов.</p>
                    </div>
                </div>
                <div class="level" data-level="10">
                    <div class="ability" data-index="30">
                        <img src="res/icons/HolyNova.png" alt="">
                        <p>Священный страж – Если ты в бою, все союзники в 10 футах получают сопротивление к некротическому урону.</p>
                    </div>
                    <div class="ability"data-index="31">
                        <img src="res/icons/FieryPayback.png" alt="">
                        <p>Ярость разрушения – Если твои хиты ниже 10%, добавляешь 2d8 урона к каждой атаке.</p>
                    </div>
                    <div class="ability" data-index="32">
                        <img src="res/icons/SealOfFury.png" alt="">
                        <p>Непроходимая твердыня – Если ты не переместился в свой ход, получаешь +2 к КД до начала следующего хода.</p>
                    </div>
                </div>
                <div class="level" data-level="11">
                    <div class="ability" data-index="33">
                        <img src="res/icons/HuntersMark.png" alt="">
                        <p>Дар крови – Каждый твой исцеляющий эффект даёт временные хиты, равные половине восстановленных.</p>
                    </div>
                    <div class="ability" data-index="34">
                        <img src="res/icons/Swift Strike.png" alt="">
                        <p>Мясорубка – Попадание по врагу снижает его КД на 1 (до конца боя, не стакается).</p>
                    </div>
                    <div class="ability" data-index="35">
                        <img src="res/icons/AspectOfTheViper.png" alt="">
                        <p>Вечный дозор – Когда враг перемещается в пределах 5 футов от тебя, можешь использовать реакцию, чтобы совершить атаку по нему.</p>
                    </div>
                </div>
                <div class="level" data-level="12">
                    <div class="ability" data-index="36">
                        <img src="res/icons/DivineAegis.png" alt="">
                        <p>Аура возрождения – Все союзники в 10 футах получают +2 к спасброскам от смерти.</p>
                    </div>
                    <div class="ability" data-index="37">
                        <img src="res/icons/BloodyThrash.png" alt="">
                        <p>Волна крови – При критическом ударе можешь атаковать всех врагов в 5 футах.</p>
                    </div>
                    <div class="ability" data-index="38">
                        <img src="res/icons/TrapLauncher.png" alt="">
                        <p>Отражение боли – Когда враг наносит тебе колющий, рубящий или дробящий урон, ты можешь использовать реакцию, чтобы он получил половину этого урона (максимум 10).</p>
                    </div>
                </div>
                <div class="level" data-level="13">
                    <div class="ability" data-index="39">
                        <img src="res/icons/InfusionOfLight.png" alt="">
                        <p>Последняя жертва – Ты можешь отдать половину своих максимальных хитов, чтобы союзник полностью восстановился. (1 раз за день).</p>
                    </div>
                    <div class="ability" data-index="40">
                        <img src="res/icons/Ascendance.png" alt="">
                        <p>Кровь бога войны – Если попал атакой два хода подряд, в этот ход можешь совершить одну атаку бесплатно.</p>
                    </div>
                    <div class="ability" data-index="41">
                        <img src="res/icons/TouchOfDeath.png" alt="">
                        <p>Железное терпение – Когда твои хиты падают до 0, соверши спасбросок Телосложения (Сл 10). При успехе остаешься на 1 хите. Можно использовать раз в короткий отдых.</p>
                    </div>
                </div>
                <div class="level" data-level="14">
                    <div class="ability" data-index="42">
                        <img src="res/icons/BloodPlague.png" alt="">
                        <p>Кровавый союз – Если ты в свой ход исцелил союзника, можешь реакцией перенаправить половину урона, который он получает, на себя.</p>
                    </div>
                    <div class="ability" data-index="43">
                        <img src="res/icons/ShadowProtection.png" alt="">
                        <p>Кровавое зрение – Можешь использовать бонусное действие, чтобы игнорировать половину брони врага. (1 раз за бой)</p>
                    </div>
                    <div class="ability" data-index="44">
                        <img src="res/icons/Halo.png" alt="">
                        <p>Щитобой – Если успешно защищаешь союзника от атаки, атакующий совершает спасбросок Силы (Сл 8 + твоя Сила + бонус мастерства). При провале враг падает ничком.</p>
                    </div>
                </div>
                <div class="level" data-level="15">
                    <div class="ability" data-index="45">
                        <img src="res/icons/SurgeOfLight.png" alt="">
                        <p>Длань Спасителя – Раз в день можешь реабилитировать союзника без негативных эффектов.</p>
                    </div>
                    <div class="ability" data-index="46">
                        <img src="res/icons/ShadowForm.png" alt="">
                        <p>Пожиратель битвы – Каждый убитый враг восстанавливает тебе 5 хитов.</p>
                    </div>
                    <div class="ability" data-index="47">
                        <img src="res/icons/FelRush.png" alt="">
                        <p>Громовой шаг – Если ты потратил все свое передвижение, можешь выбрать врагов в радиусе 5 футов и заставить их совершить спасбросок Телосложения (Сл 8 + Сила + бонус мастерства). При провале они получают 2d6 дробящего урона и сбиваются с ног. (1 раз за бой)</p>
                    </div>
                </div>
                <div class="level" data-level="16">
                    <div class="ability" data-index="48">
                        <img src="res/icons/HealingTide.png" alt="">
                        <p>Неупокоенный целитель – Если ты недееспособен, дееспособные союзники в радиусе 5 футов от твоего тела восстанавливают 1d12 за раунд.</p>
                    </div>
                    <div class="ability" data-index="49">
                        <img src="res/icons/LivingBomb.png" alt="">
                        <p>Взрыв ярости – При убийстве врага можешь оттолкнуть всех в 10 футах.</p>
                    </div>
                    <div class="ability" data-index="50">
                        <img src="res/icons/TheifsBargain.png" alt="">
                        <p>Непоколебимый дух – В начале своего хода можешь действием выбрать союзника в пределах 5 футов. Пока он рядом, этот союзник получает половину урона, который получил бы, а ты получаешь оставшуюся половину.</p>
                    </div>
                </div>
                <div class="level" data-level="17">
                    <div class="ability" data-index="51">
                        <img src="res/icons/TimeWarp.png" alt="">
                        <p>Смерть – не конец – Если ты недееспособен, можешь ожить через 1 минуту с половиной хитов. (1 раз в неделю)</p>
                    </div>
                    <div class="ability" data-index="52">
                        <img src="res/icons/GrapplingHook.png" alt="">
                        <p>Смерть как искусство – Если попадаешь по врагу критической атакой, враг не может восстановливать хиты 1 минуту.</p>
                    </div>
                    <div class="ability" data-index="53">
                        <img src="res/icons/ShroudOfConcealment.png" alt="">
                        <p>Каменные жилы – Получаешь сопротивление к дробящему, колющему и рубящему урону, если твои хиты ниже половины максимальных.</p>
                    </div>
                </div>
                <div class="level" data-level="18">
                    <div class="ability" data-index="54">
                        <img src="res/icons/Ascension.png" alt="">
                        <p>Тот, кто несёт свет – Каждый раунд исцеляешь всех дееспособных союзников на 1d6.</p>
                    </div>
                    <div class="ability" data-index="55">
                        <img src="res/icons/KidneyShot.png" alt="">
                        <p>Кровавый гнев – Если у тебя 10 хитов или меньше, все атаки наносят критический урон.</p>
                    </div>
                    <div class="ability" data-index="56">
                        <img src="res/icons/SliceDice.png" alt="">
                        <p>Кровавая клятва – Когда враг наносит тебе критический удар, ты можешь немедленно использовать реакцию, чтобы нанести ему одну атаку ближнего боя без броска атаки.</p>
                    </div>
                </div>
                <div class="level" data-level="19">
                    <div class="ability" data-index="57">
                        <img src="res/icons/VictoryRush.png" alt="">
                        <p>Живи! – Раз в день можешь сделать всех союзников неуязвимыми к урону на 1 раунд.</p>
                    </div>
                    <div class="ability" data-index="58">
                        <img src="res/icons/BladeOfJustice.png" alt="">
                        <p>Бог войны – Все успешные атаки с броском атаки выше 15 считаются критическим попаданием.</p>
                    </div>
                    <div class="ability" data-index="59">
                        <img src="res/icons/IceboundFortitude.png" alt="">
                        <p>Гвардия титанов – Используя бонусное действие, ты входишь в стойку титана (на 1 минуту):
                            Твой КД увеличивается на 3.
                            Ты получаешь сопротивление ко всему урону, кроме психического.
                            Враги в радиусе 10 футов совершают атаки с помехой против твоих союзников.
                            Можно использовать раз в долгий отдых.</p>
                    </div>
                </div>
            </div>
            <button id="save">Сохранить</button>
            </section>
        </div>
<script src="js/main.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    const className = document.body.dataset.class; // Убедись, что <body> имеет data-class="warrior"
    if (!className) {
        console.error("Не указан класс персонажа!");
        return;
    }

    const storageKey = `skillTree_${className}`;
    let skills = localStorage.getItem(storageKey) ? localStorage.getItem(storageKey).split("").map(Number) : new Array(20).fill(0);

    const levels = document.querySelectorAll(".level");

    // Обновляет UI на основе текущих данных
    function updateUI() {
        levels.forEach((level, levelIndex) => {
            level.querySelectorAll(".ability").forEach((ability, abilityIndex) => {
                ability.classList.toggle("active", skills[levelIndex] === abilityIndex + 1);
            });
        });
    }

    // Выбор или отмена выбора умения
    function handleSkillSelect(levelIndex, abilityIndex) {
        if (skills[levelIndex] === abilityIndex + 1) {
            skills[levelIndex] = 0; // Снимаем выбор
        } else {
            skills[levelIndex] = abilityIndex + 1; // Выбираем новое умение
        }
        updateUI();
    }

    // Назначаем обработчики событий на каждое умение
    levels.forEach((level, levelIndex) => {
        level.querySelectorAll(".ability").forEach((ability, abilityIndex) => {
            ability.addEventListener("click", () => handleSkillSelect(levelIndex, abilityIndex));
            ability.addEventListener("touchend", (event) => {
                event.preventDefault(); // Убирает задержку на мобильных
                handleSkillSelect(levelIndex, abilityIndex);
            });
        });
    });

    // Кнопка "Сохранить"
    document.getElementById("save").addEventListener("click", () => {
        localStorage.setItem(storageKey, skills.join("")); // Сохраняем как строку
        alert("Умения сохранены!");
    });

    // Загружаем умения при старте
    updateUI();
});
</script>
</body>
</html>