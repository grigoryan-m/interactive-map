<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF–8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alegreya+SC:ital,wght@0,400;0,500;0,700;0,800;0,900;1,400;1,500;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <base href="https://grigoryan-m.github.io/interactive-map" />
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/class.css">
    <script src="js/header.js"></script>
    <title>Следопыт</title>
</head>
<body data-class="ranger">
    <div class="center">
        <div class="center">
            <section class="">
                
            <h2>Следопыт</h2>
            <div class="tree">
                <h4>Описания веток</h4>
                <div class="level">
                    <div class="ability"><img src="res/icons/questionmark.jpg" alt="">
                    <p>Стрельба - улучшение боевых возможностей с луком/арбалетом</p></div>
                    <div class="ability">
                        <img src="res/icons/questionmark.jpg" alt="">
                        <p>Выживание - навыки ориентирования и маскировки</p>
                    </div>
                    <div class="ability">
                        <img src="res/icons/questionmark.jpg" alt="">
                        <p>Звериная связь - усиление питомца и взаимодействие с ним</p>
                    </div>
                </div>
                <hr/>
                <!-- Уровень 1 -->
<div class="level" data-level="0">
    <div class="ability" data-index="0">
        <img src="res/icons/Ability_Hunter_AimedShot.png" alt="">
        <p><strong>Меткий выстрел</strong> - Атаки из лука/арбалета получают +2 к попаданию, если не двигался в этом ходу.</p>
    </div>
    <div class="ability" data-index="1">
        <img src="res/icons/Ability_Tracking.png" alt="">
        <p><strong>Следопыт</strong> - Преимущество на проверки Мудрости для выслеживания существ.</p>
    </div>
    <div class="ability" data-index="2">
        <img src="res/icons/Ability_Hunter_BeastCall.png" alt="">
        <p><strong>Звериный компаньон</strong> - Получаешь питомца (волк/ястреб/медведь) с базовыми характеристиками.</p>
    </div>
</div>

<!-- Уровень 2 -->
<div class="level" data-level="1">
    <div class="ability" data-index="3">
        <img src="res/icons/Ability_Hunter_Quickshot.png" alt="">
        <p><strong>Быстрый выстрел</strong> - Можешь совершить одну дополнительную атаку в ход (-2 к попаданию).</p>
    </div>
    <div class="ability" data-index="4">
        <img src="res/icons/Ability_Racial_ShadowMeld.png" alt="">
        <p><strong>Маскировка</strong> - Можешь замаскироваться в природной среде (проверка Ловкости).</p>
    </div>
    <div class="ability" data-index="5">
        <img src="res/icons/Ability_Hunter_MendPet.png" alt="">
        <p><strong>Лечение питомца</strong> - Можешь лечить зверя на 1к8+Мудр (3/день).</p>
    </div>
</div>

<!-- Уровень 3 -->
<div class="level" data-level="2">
    <div class="ability" data-index="6">
        <img src="res/icons/Ability_Hunter_SniperShot.png" alt="">
        <p><strong>Убийственный выстрел</strong> - Раз в бой можешь совершить атаку с +1к8 урона.</p>
    </div>
    <div class="ability" data-index="7">
        <img src="res/icons/Ability_Hunter_Pathfinding.png" alt="">
        <p><strong>Ориентирование</strong> - Не можешь заблудиться в дикой местности. +5 к скорости группы.</p>
    </div>
    <div class="ability" data-index="8">
        <img src="res/icons/Ability_Hunter_BeastTraining.png" alt="">
        <p><strong>Дрессировка</strong> - Питомец получает +2 КД.</p>
    </div>
</div>

<!-- Уровень 4 -->
<div class="level" data-level="3">
    <div class="ability" data-index="9">
        <img src="res/icons/Ability_Hunter_CriticalShot.png" alt="">
        <p><strong>Укол в сердце</strong> - Критические попадания наносят +1к6 урона.</p>
    </div>
    <div class="ability" data-index="10">
        <img src="res/icons/Ability_Hunter_AspectOfTheMonkey.png" alt="">
        <p><strong>Обезьянья ловкость</strong> - +2 к КД и спасброскам Ловкости в природной среде.</p>
    </div>
    <div class="ability" data-index="11">
        <img src="res/icons/Ability_Hunter_Pet_Bear.png" alt="">
        <p><strong>Звериная ярость</strong> - Питомец получает +2 к урону в течение 3 раундов (1/бой).</p>
    </div>
</div>

<!-- Уровень 5 -->
<div class="level" data-level="4">
    <div class="ability" data-index="12">
        <img src="res/icons/Ability_Hunter_RunningShot.png" alt="">
        <p><strong>Стрельба на бегу</strong> - Получаешь дополнительную атаку, если потратил всю скорость на уникальное передвижение в этот ход.</p>
    </div>
    <div class="ability" data-index="13">
        <img src="res/icons/Ability_Hunter_EagleEye.png" alt="">
        <p><strong>Орлиный глаз</strong> - Удваивается дистанция точной стрельбы.</p>
    </div>
    <div class="ability" data-index="14">
        <img src="res/icons/Ability_Hunter_BeastSoothe.png" alt="">
        <p><strong>Связь с природой</strong> - Питомец получает +2 к атаке и урону, когда ваше ОЗ выше 50%.</p>
    </div>
</div>
<!-- Уровень 6 -->
<div class="level" data-level="5">
    <div class="ability" data-index="15">
        <img src="res/icons/Ability_PoisonArrow.png" alt="">
        <p><strong>Отравленный выстрел</strong> - Можешь приготовить 3 ядовитых стрелы/болта в день (1к6 урона ядом, длится 3 раунда).</p>
    </div>
    <div class="ability" data-index="16">
        <img src="res/icons/Ability_Stealth.png" alt="">
        <p><strong>Призрачный след</strong> - Оставляешь в 2 раза меньше следов и получаешь +5 к Скрытности в дикой местности.</p>
    </div>
    <div class="ability" data-index="17">
        <img src="res/icons/Ability_Hunter_Pet_Wolf.png" alt="">
        <p><strong>Слаженная атака</strong> - Если ты и питомец атакуете одну цель, питомец получает +2 к урону.</p>
    </div>
</div>

<!-- Уровень 7 -->
<div class="level" data-level="6">
    <div class="ability" data-index="18">
        <img src="res/icons/Ability_Hunter_SwiftStrike.png" alt="">
        <p><strong>Двойной выстрел</strong> - Можешь совершить две дополнительные атаки в один ход (но обе с -3 к попаданию).</p>
    </div>
    <div class="ability" data-index="19">
        <img src="res/icons/Ability_Druid_Dash.png" alt="">
        <p><strong>Реакция джунглей</strong> - При атаке по тебе можешь реакцией отступить на 10 футов (3/день).</p>
    </div>
    <div class="ability" data-index="20">
        <img src="res/icons/Ability_Hunter_Pet_Raptor.png" alt="">
        <p><strong>Звериная скорость</strong> - Питомец получает +10 футов к скорости.</p>
    </div>
</div>

<!-- Уровень 8 -->
<div class="level" data-level="7">
    <div class="ability" data-index="21">
        <img src="res/icons/Ability_TrueShot.png" alt="">
        <p><strong>Снайпер</strong> - Первый выстрел в бою игнорирует помехи и получает +5 к попаданию.</p>
    </div>
    <div class="ability" data-index="22">
        <img src="res/icons/Ability_EyeOfTheOwl.png" alt="">
        <p><strong>Ночное зрение</strong> - Видишь в темноте на 60 футов. Преимущество на Восприятие ночью.</p>
    </div>
    <div class="ability" data-index="23">
        <img src="res/icons/Ability_Hunter_BeastTaming.png" alt="">
        <p><strong>Дух природы</strong> - Питомец получает сопротивление магии и +2 ко всем спасброскам.</p>
    </div>
</div>

<!-- Уровень 9 -->
<div class="level" data-level="8">
    <div class="ability" data-index="24">
        <img src="res/icons/Ability_Whirlwind.png" alt="">
        <p><strong>Град стрел</strong> - Можешь атаковать всех врагов в 10-футовом конусе (урон 1к6, 1/бой).</p>
    </div>
    <div class="ability" data-index="25">
        <img src="res/icons/Camouflage.png" alt="">
        <p><strong>Исчезновение охотника</strong> - Можешь скрыться даже на открытой местности (проверка Скрытности с преимуществом).</p>
    </div>
    <div class="ability" data-index="26">
        <img src="res/icons/Ability_Hunter_Pet_Hyena.png" alt="">
        <p><strong>Кровавая охота</strong> - Питомец получает +1к6 урона против кровоточащих целей.</p>
    </div>
</div>

<!-- Уровень 10 -->
<div class="level" data-level="9">
    <div class="ability" data-index="27">
        <img src="res/icons/Ability_Hunter_AimedShot.png" alt="">
        <p><strong>Смертельный удар</strong> - Можешь потратить 2 раунда (включая этот) на прицеливание для атаки с 3х уроном (1/день).</p>
    </div>
    <div class="ability" data-index="28">
        <img src="res/icons/Ability_Racial_Avatar.png" alt="">
        <p><strong>Выносливость зверя</strong> - Получаешь сопротивление холоду/жаре и +10 футов скорости в природе.</p>
    </div>
    <div class="ability" data-index="29">
        <img src="res/icons/Ability_Hunter_BeastCall02.png" alt="">
        <p><strong>Единство с природой</strong> - Питомец получает все твои преимущества на спасброски и +2 к КД.</p>
    </div>
</div>
<!-- Уровень 11 -->
<div class="level" data-level="10">
    <div class="ability" data-index="30">
        <img src="res/icons/Ability_Hunter_SniperShot.png" alt="">
        <p><strong>Выстрел сквозь укрытие</strong> - Ваши стрелы игнорируют частичное укрытие (50% маскировки). Критические попадания наносят дополнительно 1d8 урона.</p>
    </div>
    <div class="ability" data-index="31">
        <img src="res/icons/Ability_Tracking.png" alt="">
        <p><strong>Неумолимый преследователь</strong> - Вы получаете преимущество на проверки Следопытства против раненых целей (ниже 50% HP). Скорость передвижения +10 футов при преследовании.</p>
    </div>
    <div class="ability" data-index="32">
        <img src="res/icons/Ability_Hunter_Pet_Vulture.png" alt="">
        <p><strong>Кормление зверя</strong> - При убийстве цели ваш питомец восстанавливает 1d8 HP. Если питомец убивает цель, вы получаете +2 к следующей атаке.</p>
    </div>
</div>

<!-- Уровень 12 -->
<div class="level" data-level="11">
    <div class="ability" data-index="33">
        <img src="res/icons/Ability_PoisonArrow.png" alt="">
        <p><strong>Смертельный яд</strong> - Ваши отравленные стрелы теперь наносят 2d6 урона ядом. Можно приготовить 5 таких стрел в день.</p>
    </div>
    <div class="ability" data-index="34">
        <img src="res/icons/Ability_Stealth.png" alt="">
        <p><strong>Призрак леса</strong> - В природной среде можете использовать действие "Спрятаться" даже если вас частично видят. +10 к Скрытности в первый раунд боя.</p>
    </div>
    <div class="ability" data-index="35">
        <img src="res/icons/Ability_Hunter_Pet_Scorpid.png" alt="">
        <p><strong>Ядовитый коготь</strong> - Атаки вашего питомца имеют 25% шанс отравить цель (1d4 урона/раунд, 3 раунда).</p>
    </div>
</div>

<!-- Уровень 13 -->
<div class="level" data-level="12">
    <div class="ability" data-index="36">
        <img src="res/icons/Ability_Whirlwind.png" alt="">
        <p><strong>Ураган стрел</strong> - Атакуете всех врагов в радиусе 15 футов (3d6 урона). 1/день.</p>
    </div>
    <div class="ability" data-index="37">
        <img src="res/icons/Ability_Druid_Dash.png" alt="">
        <p><strong>Скорость гепарда</strong> - Атаки по вам имеют помеху в первый раунд боя.</p>
    </div>
    <div class="ability" data-index="38">
        <img src="res/icons/Ability_Hunter_BeastTraining.png" alt="">
        <p><strong>Альфа-зверь</strong> - Ваш питомец получает +2 к КД и +5 футов скорости.</p>
    </div>
</div>

<!-- Уровень 14 -->
<div class="level" data-level="13">
    <div class="ability" data-index="39">
        <img src="res/icons/Ability_TrueShot.png" alt="">
        <p><strong>Стрела судьбы</strong> - Можете совершить гарантированное попадание дальнобойной атакой обычной стрелой (игнорируя помехи и укрытие). Урон увеличивается вдвое. 1/день.</p>
    </div>
    <div class="ability" data-index="40">
        <img src="res/icons/Ability_EyeOfTheOwl.png" alt="">
        <p><strong>Око ястреба</strong> - Видите в полной темноте на 120 футов. Преимущество на все проверки Восприятия. Застать вас врасплох невозможно.</p>
    </div>
    <div class="ability" data-index="41">
        <img src="res/icons/Ability_Hunter_Pet_WindSerpent.png" alt="">
        <p><strong>Связь духа</strong> - Можете видеть глазами питомца на расстоянии до 1 мили.
        </div>
    </div>
    <!-- Уровень 15 -->
<div class="level" data-level="14">
    <div class="ability" data-index="42">
        <img src="res/icons/Ability_Hunter_RunningShot.png" alt="">
        <p><strong>Танец смерти</strong> - При убийстве врага получаете дополнительное действие для атаки.</p>
    </div>
    <div class="ability" data-index="43">
        <img src="res/icons/Camouflage.png" alt="">
        <p><strong>Мастер маскировки</strong> - Можете замаскироваться под окружающую среду, если находетесь в природной местности, за 1 бонусное действие.</p>
    </div>
    <div class="ability" data-index="44">
        <img src="res/icons/Ability_Hunter_BeastCall02.png" alt="">
        <p><strong>Зов стаи</strong> - Можете временно призвать 1d4 волков на 1 час (1/день). Ваш основной питомец получает +2 к урону в их присутствии.</p>
    </div>
</div>
<!-- Уровень 15 (16 уровень персонажа) -->
<div class="level" data-level="15">
    <div class="ability" data-index="45">
        <img src="res/icons/Ability_Hunter_CriticalShot.png" alt="">
        <p><strong>Смертельная точность</strong> - Критические попадания происходят при 19-20. Дополнительный урон от критических ударов увеличивается на 1d10.</p>
    </div>
    <div class="ability" data-index="46">
        <img src="res/icons/Ability_Racial_ShadowMeld.png" alt="">
        <p><strong>Теневой клинок</strong> - Атаки из скрытности наносят дополнительно 3d6 урона. После атаки можете попытаться скрыться снова.</p>
    </div>
    <div class="ability" data-index="47">
        <img src="res/icons/Ability_Hunter_Pet_Wolf.png" alt="">
        <p><strong>Альфа-стаи</strong> - Ваш питомец может командовать другими нейтральными зверями в радиусе 60 футов, давая им +2 к атаке и урону.</p>
    </div>
</div>

<!-- Уровень 16 (17 уровень персонажа) -->
<div class="level" data-level="16">
    <div class="ability" data-index="48">
        <img src="res/icons/Ability_Whirlwind.png" alt="">
        <p><strong>Град шипов</strong> - Можете выпустить 12 стрел во всех направлениях (8d6 урона, спасбросок Ловкости DC 17 для половины урона). 1/день.</p>
    </div>
    <div class="ability" data-index="49">
        <img src="res/icons/Ability_EyeOfTheOwl.png" alt="">
        <p><strong>Пророческое зрение</strong> - Видите на 1 милю, замечаете невидимых существ. Преимущество на инициативу и проверки Восприятия.</p>
    </div>
    <div class="ability" data-index="50">
        <img src="res/icons/Ability_Druid_SupriseAttack.png" alt="">
        <p><strong>Дух природы</strong> - Ваш питомец может телепортироваться к вам на 60 футов бонусным действием.</p>
    </div>
</div>

<!-- Уровень 17 (18 уровень персонажа) -->
<div class="level" data-level="17">
    <div class="ability" data-index="51">
        <img src="res/icons/Ability_TrueShot.png" alt="">
        <p><strong>Стрела рока</strong> - Автоматическое попадание, игнорирует сопротивление/иммунитет. Наносит 6d10 урона (1/день).</p>
    </div>
    <div class="ability" data-index="52">
        <img src="res/icons/Camouflage.png" alt="">
        <p><strong>Исчезновение</strong> - Можете стать невидимым на 1 минуту в природной среде. Атаки прерывают эффект (3/день).</p>
    </div>
    <div class="ability" data-index="53">
        <img src="res/icons/Ability_Hunter_Pet_WindSerpent.png" alt="">
        <p><strong>Воплощение зверя</strong> - На 2 раунда получаете +50 временных HP (1/день).</p>
    </div>
</div>

<!-- Уровень 18 (19 уровень персонажа) -->
<div class="level" data-level="18">
    <div class="ability" data-index="54">
        <img src="res/icons/Ability_PoisonArrow.png" alt="">
        <p><strong>Яд древних</strong> - Ваши ядовитые стрелы парализуют цель на 1 раунд (Спасбросок Телосложения DC 18). 3 стрелы/день.</p>
    </div>
    <div class="ability" data-index="55">
        <img src="res/icons/Ability_Druid_Dash.png" alt="">
        <p><strong>Ветер в спину</strong> - Постоянно действует эффект "Ускорения". В бою можете совершить два перемещения за ход.</p>
    </div>
    <div class="ability" data-index="56">
        <img src="res/icons/Ability_Hunter_BeastCall02.png" alt="">
        <p><strong>Зов предков</strong> - Призываете 1d4+1 духовных зверей на 1 час (1/день). Каждый дает +1d6 урона вам и питомцу.</p>
    </div>
</div>

<!-- Уровень 19 (20 уровень персонажа) -->
<div class="level" data-level="19">
    <div class="ability" data-index="57">
        <img src="res/icons/Ability_Hunter_SniperShot.png" alt="">
        <p><strong>Легендарный охотник</strong> - Все атаки из лука считаются критическими при попадании по существу с больше половины хитов.</p>
    </div>
    <div class="ability" data-index="58">
        <img src="res/icons/Ability_Tracking.png" alt="">
        <p><strong>Властелин дикой природы</strong> - Вы становитесь невидимыми для всех существ, кроме избранных целей. +10 ко всем навыкам выживания.</p>
    </div>
    <div class="ability" data-index="59">
        <img src="res/icons/Ability_Hunter_Pet_Raptor.png" alt="">
        <p><strong>Единство с природой</strong> - Питомец становится легендарным существом (летает, невидим в засаде, регенерирует 10 HP/раунд).</p>
    </div>
</div>
</div>

<button id="save">Сохранить</button>
</section>
    <script src="js/main.js"></script>
    <script>
document.addEventListener("DOMContentLoaded", () => {
    const className = document.body.dataset.class; // Убедись, что <body> имеет data-class
    if (!className) {
        console.error("Не указан класс персонажа!");
        return;
    }

    const storageKey = `skillTree_${className}`;
    let skills = localStorage.getItem(storageKey) ? localStorage.getItem(storageKey).split("").map(Number) : new Array(20).fill(0);

    const levels = document.querySelectorAll(".level");

    // Обновляет UI на основе текущих данных
    function updateUI() {
        levels.forEach((level, levelIndex) => {
            level.querySelectorAll(".ability").forEach((ability, abilityIndex) => {
                ability.classList.toggle("active", skills[levelIndex] === abilityIndex + 1);
            });
        });
    }

    // Выбор или отмена выбора умения
    function handleSkillSelect(levelIndex, abilityIndex) {
        if (skills[levelIndex] === abilityIndex + 1) {
            skills[levelIndex] = 0; // Снимаем выбор
        } else {
            skills[levelIndex] = abilityIndex + 1; // Выбираем новое умение
        }
        updateUI();
    }

    // Назначаем обработчики событий на каждое умение
    levels.forEach((level, levelIndex) => {
        level.querySelectorAll(".ability").forEach((ability, abilityIndex) => {
            ability.addEventListener("click", () => handleSkillSelect(levelIndex, abilityIndex));
            ability.addEventListener("touchend", (event) => {
                event.preventDefault(); // Убирает задержку на мобильных
                handleSkillSelect(levelIndex, abilityIndex);
            });
        });
    });

    // Кнопка "Сохранить"
    document.getElementById("save").addEventListener("click", () => {
        localStorage.setItem(storageKey, skills.join("")); // Сохраняем как строку
        alert("Умения сохранены!");
    });

    // Загружаем умения при старте
    updateUI();
});
    </script>
    </body>